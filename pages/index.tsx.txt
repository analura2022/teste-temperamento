import { useState } from "react";
import { loadStripe } from "@stripe/stripe-js";
import { Button } from "@/components/ui/button";  // Supondo que você tenha um componente de botão

const perguntas = [
  { texto: "Quando estou em grupo, geralmente:", opcoes: [
    { texto: "Tomo a liderança naturalmente", tipo: "colerico" },
    { texto: "Sou animado e gosto de conversar", tipo: "sanguineo" },
    { texto: "Prefiro ouvir e observar", tipo: "flematico" },
    { texto: "Sou reservado e fico desconfortável com muita gente", tipo: "melancolico" }
  ]},
  // Continue adicionando as outras perguntas conforme discutido antes
];

export default function Home() {
  const [respostas, setRespostas] = useState(Array(perguntas.length).fill(null));

  const handleResposta = (index, tipo) => {
    const novasRespostas = [...respostas];
    novasRespostas[index] = tipo;
    setRespostas(novasRespostas);
  };

  const iniciarPagamento = async () => {
    const resposta = await fetch("/api/checkout_sessions", {
      method: "POST",
      body: JSON.stringify({ respostas }),
    });
    const { sessionId } = await resposta.json();
    const stripe = await loadStripe('pk_test_xxx'); // Substitua pela sua chave pública do Stripe
    await stripe.redirectToCheckout({ sessionId });
  };

  return (
    <div className="max-w-2xl mx-auto p-4">
      <h1 className="text-2xl font-bold mb-4">Questionário de Temperamento</h1>
      {perguntas.map((pergunta, index) => (
        <div key={index} className="mb-6">
          <p className="font-medium mb-2">{index + 1}. {pergunta.texto}</p>
          <div className="space-y-2">
            {pergunta.opcoes.map((opcao, i) => (
              <label key={i} className="block">
                <input
                  type="radio"
                  name={`pergunta-${index}`}
                  value={opcao.tipo}
                  onChange={() => handleResposta(index, opcao.tipo)}
                  checked={respostas[index] === opcao.tipo}
                  className="mr-2"
                />
                {opcao.texto}
              </label>
            ))}
          </div>
        </div>
      ))}
      <Button onClick={iniciarPagamento} className="mt-4">
        Ver Resultado
      </Button>
    </div>
  );
}
